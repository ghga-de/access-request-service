components:
  schemas:
    AccessRequest:
      additionalProperties: false
      description: All data that describes an access request.
      properties:
        access_ends:
          description: Requested end date of access
          format: date-time
          title: Access Ends
          type: string
        access_starts:
          description: Requested start date of access
          format: date-time
          title: Access Starts
          type: string
        changed_by:
          anyOf:
          - type: string
          - type: 'null'
          description: The ID of the data steward who made the status change
          title: Changed By
        dac_alias:
          description: The alias of the Data Access Committee.
          title: Dac Alias
          type: string
        dataset_id:
          description: ID of the dataset for which access is requested
          pattern: ^[A-Z]{1,6}[0-9]{3,18}$
          title: Dataset Id
          type: string
        dataset_title:
          description: Title of the dataset
          title: Dataset Title
          type: string
        email:
          description: Contact e-mail address of the requester
          title: Email
          type: string
        full_user_name:
          description: The requester's full name including academic title
          title: Full User Name
          type: string
        id:
          description: ID of the access request
          title: Id
          type: string
        iva_id:
          anyOf:
          - type: string
          - type: 'null'
          description: ID of the IVA to be used for this request, but this can also
            be specified later
          title: Iva Id
        request_created:
          description: Creation date of the access request
          format: date-time
          title: Request Created
          type: string
        request_text:
          description: Text note submitted with the request
          title: Request Text
          type: string
        status:
          $ref: '#/components/schemas/AccessRequestStatus'
          default: pending
          description: The status of this access request
        status_changed:
          anyOf:
          - format: date-time
            type: string
          - type: 'null'
          description: Last change date of the status of this request
          title: Status Changed
        user_id:
          description: ID of the user who requests access
          title: User Id
          type: string
      required:
      - user_id
      - dataset_id
      - dataset_title
      - dac_alias
      - email
      - request_text
      - access_starts
      - access_ends
      - full_user_name
      - request_created
      title: AccessRequest
      type: object
    AccessRequestCreationData:
      additionalProperties: false
      description: All data necessary to create an access request.
      properties:
        access_ends:
          description: Requested end date of access
          format: date-time
          title: Access Ends
          type: string
        access_starts:
          description: Requested start date of access
          format: date-time
          title: Access Starts
          type: string
        dac_alias:
          description: The alias of the Data Access Committee.
          title: Dac Alias
          type: string
        dataset_id:
          description: ID of the dataset for which access is requested
          pattern: ^[A-Z]{1,6}[0-9]{3,18}$
          title: Dataset Id
          type: string
        dataset_title:
          description: Title of the dataset
          title: Dataset Title
          type: string
        email:
          description: Contact e-mail address of the requester
          title: Email
          type: string
        iva_id:
          anyOf:
          - type: string
          - type: 'null'
          description: ID of the IVA to be used for this request, but this can also
            be specified later
          title: Iva Id
        request_text:
          description: Text note submitted with the request
          title: Request Text
          type: string
        user_id:
          description: ID of the user who requests access
          title: User Id
          type: string
      required:
      - user_id
      - dataset_id
      - dataset_title
      - dac_alias
      - email
      - request_text
      - access_starts
      - access_ends
      title: AccessRequestCreationData
      type: object
    AccessRequestPatchData:
      additionalProperties: false
      description: All data that describes an access request patch.
      properties:
        access_ends:
          anyOf:
          - format: date-time
            type: string
          - type: 'null'
          description: Modified end date of access
          title: Access Ends
        access_starts:
          anyOf:
          - format: date-time
            type: string
          - type: 'null'
          description: Modified start date of access
          title: Access Starts
        iva_id:
          anyOf:
          - type: string
          - type: 'null'
          description: ID of the IVA to be used for this request
          title: Iva Id
        status:
          anyOf:
          - $ref: '#/components/schemas/AccessRequestStatus'
          - type: 'null'
          description: The new status of this access request
      title: AccessRequestPatchData
      type: object
    AccessRequestStatus:
      description: The status of an access request.
      enum:
      - allowed
      - denied
      - pending
      title: AccessRequestStatus
      type: string
  securitySchemes:
    HTTPBearer:
      scheme: bearer
      type: http
info:
  description: A service managing access requests for the GHGA Data Portal
  title: Access Request Service
  version: 4.0.0
openapi: 3.1.0
paths:
  /access-requests:
    get:
      description: Endpoint used to get existing access requests
      operationId: get_access_request
      parameters:
      - in: query
        name: dataset_id
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          title: Dataset Id
      - in: query
        name: user_id
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          title: User Id
      - in: query
        name: status
        required: false
        schema:
          anyOf:
          - $ref: '#/components/schemas/AccessRequestStatus'
          - type: 'null'
          title: Status
      responses:
        '200':
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/AccessRequest'
                title: Response 200 Get Access Request
                type: array
          description: Access requests have been fetched.
        '403':
          description: Not authorized to get access requests.
        '422':
          description: Validation error in submitted parameters.
      security:
      - HTTPBearer: []
      summary: Get access requests
      tags:
      - AccessRequests
    post:
      description: Endpoint used to create a new access request
      operationId: create_access_request
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessRequestCreationData'
        required: true
      responses:
        '201':
          content:
            application/json:
              schema:
                title: Response 201 Create Access Request
                type: string
          description: Access request was successfully created
        '403':
          description: Not authorized to create an access request.
        '422':
          description: Validation error in submitted data.
      security:
      - HTTPBearer: []
      summary: Create an access request
      tags:
      - AccessRequests
  /access-requests/{access_request_id}:
    patch:
      description: Endpoint used to set the status or modify other fields of an access
        request
      operationId: patch_access_request
      parameters:
      - in: path
        name: access_request_id
        required: true
        schema:
          title: Access Request Id
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessRequestPatchData'
        required: true
      responses:
        '204':
          description: Access request was successfully changed
        '403':
          description: Not authorized to change access request.
        '404':
          description: Access request does not exist.
        '422':
          description: Validation error in submitted data.
      security:
      - HTTPBearer: []
      summary: Set status or modify other fields of an access request
      tags:
      - AccessRequests
  /health:
    get:
      description: Used to test if this service is alive
      operationId: health_health_get
      responses:
        '200':
          content:
            application/json:
              schema: {}
          description: Successful Response
      summary: health
      tags:
      - AccessRequests
tags:
- name: AccessRequests
